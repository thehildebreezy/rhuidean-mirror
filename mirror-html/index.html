<html>
    <head>
        <title>Stone of Tear Mirror Display</title>
        <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
        <link type="text/css" rel="stylesheet" href="style.css" />
        <link type="text/css" rel="stylesheet" href="weather-icons-master/css/weather-icons.css" />
        <script type="text/javascript" src="update-display.js"></script>
        
        <script>
            
            function checkMessages(){
                pollMessage().then(function(res){
                    console.log("TESTING\n")
                    console.log(res)
                })
            }

            function initDisplay(){
                Update.display('{"type":"time","message":1595709800}')
                Update.display('{"type":"weather","message":{"coord":{"lon":-79.01,"lat":35.06},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"base":"stations","main":{"temp":306.06,"feels_like":309.15,"temp_min":305.93,"temp_max":306.15,"pressure":1018,"humidity":52},"visibility":10000,"wind":{"speed":2.1,"deg":200},"clouds":{"all":75},"dt":1595709916,"sys":{"type":1,"id":4062,"country":"US","sunrise":1595672423,"sunset":1595723067},"timezone":-14400,"id":0,"name":"Fayetteville","cod":200}}')
                Update.display('{"type":"forecast","message":{"cod":"200","message":0,"cnt":40,"list":[{"dt":1595764800,"main":{"temp":298.26,"feels_like":300.93,"temp_min":298.26,"temp_max":298.26,"pressure":1020,"sea_level":1020,"grnd_level":1012,"humidity":81,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.61,"deg":234},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2020-07-26 12:00:00"},{"dt":1595851200,"main":{"temp":298.55,"feels_like":300.39,"temp_min":298.55,"temp_max":298.55,"pressure":1017,"sea_level":1017,"grnd_level":1009,"humidity":80,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":5},"wind":{"speed":3.86,"deg":236},"visibility":10000,"pop":0.01,"sys":{"pod":"d"},"dt_txt":"2020-07-27 12:00:00"},{"dt":1595937600,"main":{"temp":299.33,"feels_like":301.11,"temp_min":299.33,"temp_max":299.33,"pressure":1014,"sea_level":1014,"grnd_level":1006,"humidity":77,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"clouds":{"all":18},"wind":{"speed":4.04,"deg":233},"visibility":10000,"pop":0.04,"sys":{"pod":"d"},"dt_txt":"2020-07-28 12:00:00"},{"dt":1596024000,"main":{"temp":298.63,"feels_like":302.29,"temp_min":298.63,"temp_max":298.63,"pressure":1014,"sea_level":1014,"grnd_level":1006,"humidity":84,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":93},"wind":{"speed":1.93,"deg":253},"visibility":10000,"pop":0.34,"rain":{"3h":0.76},"sys":{"pod":"d"},"dt_txt":"2020-07-29 12:00:00"},{"dt":1596110400,"main":{"temp":297.68,"feels_like":300.19,"temp_min":297.68,"temp_max":297.68,"pressure":1013,"sea_level":1013,"grnd_level":1005,"humidity":85,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":56},"wind":{"speed":3.01,"deg":218},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2020-07-30 12:00:00"}],"city":{"name":"Fayetteville","coord":{"lat":35.0583,"lon":-79.008},"country":"US","timezone":-14400,"sunrise":1595672423,"sunset":1595723066}}}')
                serviceUpdate()
                setInterval(serviceUpdate,10*60*1000)
                setInterval(checkMessages,1*1000)
            }

            function updateDisplay( message ){
                Update.display( message )
            }
        </script>
        
    </head>
    <body onload="initDisplay()">
        <div class="upper left">
            <div id="time">
                8:42am
            </div>
        </div>
        <div class="upper right">
            <div id="weather">
                74&deg;F
                
            </div>
            <div id="forecast">
                Forecast
            </div>
        </div>
        <div class="lower left"></div>
        <div class="lower right"></div>

    </body>
</html>